angular.module("employeeTracker").controller("EmployeeController",["$rootScope","$cookies","$scope","$state","EmployeeDataOp","Access",function(e,t,o,a,n,s){function c(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}function r(){n.getEmployeeList().then(function(e){o.itemList=e.data,o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,a=t+o.numPerPage;o.filteredList=o.itemList.slice(t,a)}).catch(function(e){console.log(e)})}o.newItem={},o.selectedItem={},o.itemList=[],o.filteredList=[],o.item={},o.keyword="",o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=25,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.error="",o.success_msg="",o.sortType="employeeNumber",o.sortReverse=!1,o.toggleSort=function(e){o.sortType=e,o.sortReverse=!o.sortReverse},token=t.get("tracker-token"),void 0==token?a.go("landing"):s.getClaimsFromToken(token).then(function(e){data=e.data,data.authenticated&&(s.user(data.principal.user),"ADMIN"!=data.principal.user.role.role&&a.go("home"))}).catch(function(e){t.remove("tracker-token"),s.user(void 0),a.go("landing")}),r(),s.showNav(!0),o.search=function(){},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,c()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.setSelectedItem=function(e){o.selectedItem=e,console.log(e)},o.addEmployee=function(){n.addEmployee(o.newItem).then(function(e){o.success_message="Employee added succesfully!",$("#add-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r()}).catch(function(e){console.log(e),o.error=e.data.message})},o.editEmployee=function(){n.editEmployee(o.selectedItem).then(function(e){o.success_message="Employee updated succesfully!",$("#edit-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r()}).catch(function(e){console.log(e),o.error=e.data.message})},$("#edit-employee").on("hidden.bs.modal",function(){})}]);