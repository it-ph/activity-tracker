angular.module("employeeTracker",["ui.router","ngCookies","ui.bootstrap","ui.bootstrap.datetimepicker","AxelSoft","ngStomp","ngFileSaver"]),angular.module("employeeTracker").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/"),e.state("home",{url:"/",templateUrl:"/ActivityTracker/app/partials/home.html",controller:"DashboardController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.resolve():o.reject(),o.promise}]}}).state("login",{url:"/login",templateUrl:"/ActivityTracker/app/partials/login.html",controller:"LoginController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.reject():o.resolve(),o.promise}]}}).state("user-history",{url:"/user-history",templateUrl:"/ActivityTracker/app/partials/user-history.html",controller:"UserTaskHistoryController",resolve:{isSupervisor:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"SUPERVISOR"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("tasks",{url:"/tasks",templateUrl:"/ActivityTracker/app/partials/task.html",controller:"TaskController",resolve:{isAdmin:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("employees",{url:"/employees",templateUrl:"/ActivityTracker/app/partials/employee.html",controller:"EmployeeController",resolve:{isAdmin:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("groups",{url:"/groups",templateUrl:"/ActivityTracker/app/partials/group2.html",controller:"GroupController",resolve:{isNotUser:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"USER"!=t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("accounts",{url:"/accounts",templateUrl:"/ActivityTracker/app/partials/account.html",controller:"AccountController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("profile",{url:"/profile",templateUrl:"/ActivityTracker/app/partials/profile.html",controller:"ProfileController",resolve:{isNotUser:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.resolve():o.reject(),o.promise}]}}).state("task-preferrences",{url:"/task-preferrences",templateUrl:"/ActivityTracker/app/partials/task-preferrences.html",controller:"TaskPreferrenceController",resolve:{isUser:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"USER"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}})}]),angular.module("employeeTracker").run(["$state","$cookies","$http","LoginDataOp","Access",function(t,o,r,e,a){token=o.get("tracker-token"),a.getClaimsFromToken(token).then(function(e){data=e.data,""==data?t.go("login"):(r.defaults.headers.common.Authorization="Bearer "+token,o.put("tracker-token",token),a.user(data.principal.user),t.go("home"))}).catch(function(e){console.log(e),t.go("login")})}]),angular.module("employeeTracker").filter("durationToTime",[function(){return function(e,t){return t?moment.utc(moment.duration(e).asMilliseconds()).format("HH:mm:ss"):"N/A"}}]),angular.module("employeeTracker").filter("dateToMoment",[function(){return function(e,t){return t?moment(e).format("MMM DD YYYY h:mm:ss a"):"--"}}]),angular.module("employeeTracker").filter("dateToUtc",["$filter",function(o){return function(e,t){return t?o("date")(new Date(moment.utc(e).format("MMM DD YYYY h:mm:ss a")),"MMM. dd, yyyy h:mm:ss a"):"--"}}]),angular.module("employeeTracker").controller("AccountController",["$rootScope","$cookies","$scope","$state","$filter","AccountDataOp","EmployeeDataOp","Access",function(e,t,r,o,a,s,n,i){function c(){s.getAccountList().then(function(e){r.itemList.data=e.data,r.itemList.orig_data=e.data,r.itemList.totalItems=e.data.length,r.itemList.refresh()}).catch(function(e){console.log(e)}),s.getRoleList().then(function(e){r.roleList=e.data,r.newRole.user.role=0<r.roleList.length?r.roleList[0]:{}}).catch(function(e){console.log(e)})}r.itemList=[],r.filteredList=[],r.item={},r.newItem={},r.selectedItem={},r.employeeList=[],r.selectedEmployee={},r.roleList=[],r.totalItems=null,r.currentPage=1,r.maxSize=5,r.numPerPage=10,r.search_keyword="",r.employee_search="",r.error="",r.success_msg="",r.numPerPageCap=[10,25,50,100],r.pageCap=r.numPerPageCap[0],r.numPerPage=r.numPerPageCap[0],r.newItem={user:{role:{}},employee:{}},r.newRole={user:{role:{}}},r.changeNumPerPage=function(){r.numPerPage=r.pageCap,refresh()},c(),r.loadAccount=function(){r.error="",n.getEmployeeList().then(function(e){r.employeeList=e.data}).catch(function(e){console.log(e)}),s.getRoleList().then(function(e){r.roleList=e.data,r.newItem.user.role=0<r.roleList.length?r.roleList[0]:{}}).catch(function(e){console.log(e)})},r.searchItem=function(){if(""==r.search_keyword)refresh();else{r.searchList=a("filter")(r.itemList,r.search_keyword),r.totalItems=r.searchList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.searchList.slice(e,t)}},r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)},r.setSelectedItem=function(e){r.selectedItem=e},r.showModal=function(){r.error=""},r.hideModal=function(){r.error=""},r.addAccount=function(){r.error="",angular.equals({},r.newItem.employee)?r.error="Please select an employee":s.addAccount(r.newItem).then(function(e){r.success_message="User account added succesfully!",$("#add-account").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error=""}).catch(function(e){console.log(e),r.error=e.data.message})},r.showChangeRoleModal=function(e){r.newRole=e,r.newRole.user.role=a("filter")(r.roleList,e.user.role.role)[0],$("#edit-role").modal("show")},r.changeAccountRole=function(){s.changeAccountRole(r.newRole).then(function(e){r.success_message="User role updated succesfully!",$("#edit-role").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error=""}).catch(function(e){console.log(e)})},r.updateAccount=function(){s.updateAccount(r.selectedItem).then(function(e){r.success_message="User account updated succesfully!",$("#edit-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error=""}).catch(function(e){console.log(e),r.error=e.data.message})},r.disableAccount=function(t,o){s.disableAccount(t).then(function(e){r.success_message="Account disabled succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error="",r.refreshData(t,o)}).catch(function(e){r.error=e.data.message})},r.enableAccount=function(t,o){s.enableAccount(t).then(function(e){r.success_message="Account enabled succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error="",r.refreshData(t,o)}).catch(function(e){r.error=e.data.message})},r.resetAccount=function(e,t){s.resetAccount(e).then(function(e){r.success_message="Password reset succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error=""}).catch(function(e){r.error=e.data.message})},r.itemList={currentPage:1,maxSize:6,numPerPage:10,totalItems:0,data:[],orig_data:[],filteredList:[],search_keyword:void 0,pageChanged:function(){var e=(this.currentPage-1)*this.numPerPage,t=e+this.numPerPage;this.filteredList=this.data.slice(e,t)},refresh:function(){begin=(this.currentPage-1)*this.numPerPage,end=begin+this.numPerPage,this.filteredList=this.data.slice(begin,end)},searchAccount:function(){this.data=a("filter")(this.orig_data,this.search_keyword),this.totalItems=this.data.length,this.refresh()}},r.refreshData=function(e,t){console.log(t),console.log(e),console.log(r.itemList[t]),s.getAccount(e.id).then(function(e){c()}).catch(function(e){})}}]),angular.module("employeeTracker").controller("EmployeeTaskController",["$rootScope","$cookies","$scope","$state","$stomp","$filter","TaskDataOp","Access",function(e,t,o,r,a,s,n,i){o.success_message="",o.itemList=[],o.filteredList=[],o.item={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.taskPreferrences=[],o.error="",o.success_msg="",o.preferrences=[],o.taskWithRemarks=void 0,o.loading=!1,i.showNav(!0),o.items={canAddTask:!1,itemList:[],orig_list:[],filteredList:[],taskList:[],taskPreferrences:[],taskSelection:[],totalItems:void 0,currentPage:1,maxSize:5,numPerPage:10,search_keyword:void 0,numPerPageCap:[10,25,50,100],prefHasLoaded:!1,pageChanged:function(){var e=(this.currentPage-1)*this.numPerPage,t=e+this.numPerPage;this.filteredList=this.orig_list.slice(e,t)},changeNumPerPage:function(){this.totalItems=this.orig_list.length,begin=(this.currentPage-1)*this.numPerPage,end=begin+this.numPerPage,this.filteredList=this.orig_list.slice(begin,end)},searchTask:function(){this.itemList=s("filter")(this.orig_list,this.search_keyword),console.log(this.itemList)},refresh:function(){this.totalItems=this.itemList.length;var e=(this.currentPage-1)*this.numPerPage,t=e+this.numPerPage;this.filteredList=this.itemList.slice(e,t)},loadTaskList:function(t){n.getMyTaskList().then(function(e){o.items.itemList=e.data,o.items.orig_list=e.data,0<o.items.orig_list.length?o.items.canAddTask=null!=o.items.orig_list[0].endDate:o.items.canAddTask=!0,begin=(o.items.currentPage-1)*o.items.numPerPage,end=begin+o.items.numPerPage,o.items.filteredList=o.items.orig_list.slice(begin,end),o.items.totalItems=o.items.orig_list.length,t()}).catch(function(e){console.log(e)})},loadPreferrences:function(t){n.getTaskPreferrences().then(function(e){o.items.taskPreferrences=e.data,o.items.taskSelection=0<e.data.length?e.data:o.items.taskList,t()}).catch(function(e){console.log(e)})},saveRemarks:function(){n.addRemarks(o.taskWithRemarks).then(function(e){console.log(e),$("#remarks").modal("hide"),o.success_msg="Remarks added succesfully!",$("#successModal").modal("show"),o.items.loadTaskList(function(){}),o.$emit("updateTaskEmit",o.taskWithRemarks),setTimeout(function(){$("#successModal").modal("hide")},3e3)}).catch(function(e){console.log(e)})},newTask:function(){$("#add-task").modal("show")},addTask:function(){o.selectedTask?n.addEmployeeTask(o.selectedTask).then(function(e){o.$emit("addTaskEmit",o.items.itemList[0]),o.success_msg="Task added succesfully!",o.selectedTask=void 0,o.error=void 0,o.items.loadTaskList(function(){$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3)})}).catch(function(e){}):o.error="Please select a task"},endTask:function(e){n.endEmployeeTask(e).then(function(e){o.error=void 0,o.success_msg="Task ended succesfully",o.items.loadTaskList(function(){}),o.$emit("endTaskEmit",o.items.itemList[0]),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide"),$success_msg=void 0},3e3)}).catch(function(e){console.log(e),o.error="Something went wrong"})}},o.items.loadTaskList(function(){}),o.items.loadPreferrences(function(){o.loading=!1}),o.changeNumPerPage=function(){o.numPerPage=o.pageCap,function(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.emitEvent=function(e,t){o.$emit(e,t)},o.canAddTask=!1,o.endTask=function(e){e.startDate=null,e.endDate=null,n.endEmployeeTask(e).then(function(e){o.success_message="Task ended!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.$emit("endTaskEmit",o.itemList[0]),loadData()}).catch(function(e){console.log(e)})},o.taskList=[],o.selectedTask=void 0,o.loadTask=function(){n.getTaskList().then(function(e){o.taskList=0<o.preferrences.length?o.preferrences:e.data}).catch(function(e){console.log(e)})},o.loadTask(),o.addRemarks=function(e){o.taskWithRemarks=e,$("#remarks").modal("show")},o.saveRemarks=function(){console.log(o.taskWithRemarks),n.addRemarks(o.taskWithRemarks).then(function(e){console.log(e),$("#remarks").modal("hide"),o.success_message="Remarks added succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),loadData()}).catch(function(e){console.log(e)})},o.addTask=function(){n.addEmployeeTask(o.selectedTask).then(function(e){o.success_message="New task started!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),loadData()}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("EmployeeController",["$rootScope","$cookies","$scope","$state","$filter","EmployeeDataOp","Access",function(e,t,o,r,a,s,n){function i(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}function c(){s.getEmployeeList().then(function(e){o.itemList.data=e.data,o.itemList.orig_data=e.data,o.itemList.totalItems=e.data.length,o.itemList.refresh()}).catch(function(e){console.log(e)})}o.newItem={},o.selectedItem={data:void 0,index:void 0},o.itemList=[],o.filteredList=[],o.item={},o.keyword="",o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=25,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.error="",o.success_msg="",c(),n.showNav(!0),o.searchItem=function(){if(""==o.search_keyword)i();else{o.searchList=a("filter")(o.itemList,o.search_keyword),o.totalItems=o.searchList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.searchList.slice(e,t)}},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,i()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.setSelectedItem=function(e){o.selectedItem.data=e},o.addEmployee=function(){s.addEmployee(o.newItem).then(function(e){o.success_message="Employee added succesfully!",$("#add-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide"),c()},3e3)}).catch(function(e){console.log(e),o.error=e.data.message})},o.editEmployee=function(){s.editEmployee(o.selectedItem.data).then(function(e){o.success_message="Employee updated succesfully!",$("#edit-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.refreshData(o.selectedItem.data.id,o.selectedItem.index)}).catch(function(e){console.log(e),o.error=e.data.message})},o.refreshData=function(e,t){s.getEmployee(e).then(function(e){console.log(e),o.itemList[t]=e.data}).catch(function(e){console.log(e)})},o.itemList={currentPage:1,maxSize:6,numPerPage:10,totalItems:0,data:[],orig_data:[],filteredList:[],search_keyword:void 0,pageChanged:function(){var e=(this.currentPage-1)*this.numPerPage,t=e+this.numPerPage;this.filteredList=this.data.slice(e,t)},refresh:function(){begin=(this.currentPage-1)*this.numPerPage,end=begin+this.numPerPage,this.filteredList=this.data.slice(begin,end)},searchEmployee:function(){this.data=a("filter")(this.orig_data,this.search_keyword),this.refresh(),this.totalItems=this.data.length}}}]),angular.module("employeeTracker").controller("GroupDetailController",["$rootScope","$scope","$cookies","$state","$stateParams","Access",function(e,t,o,r,a,s){token=o.get("tracker-token"),null==token?r.go("landing"):s.getClaimsFromToken(token).then(function(e){data=e.data,data.authenticated&&(s.user(data.principal.user),"SUPERVISOR"!=data.principal.user.role.role&&r.go("home"))}).catch(function(e){o.remove("tracker-token"),s.user(void 0),r.go("landing")}),null==a.group&&r.go("home"),t.group=a.group,t.memberList=[],t.adminList=[],t.adminList=t.group.admin,t.memberList=t.group.members}]),angular.module("employeeTracker").controller("GroupController",["$rootScope","$scope","$cookies","$state","$filter","GroupDataOp","Access",function(e,r,t,o,a,s,n){function i(){r.totalItems=r.itemList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)}function c(){r.error="",s.getGroupList().then(function(e){r.itemList=e.data,r.totalItems=r.itemList.length;var t=(r.currentPage-1)*r.numPerPage,o=t+r.numPerPage;r.filteredList=r.itemList.slice(t,o)}).catch(function(e){console.log(e)})}r.itemList=[],r.filteredList=[],r.item={},r.newItem={},r.adminList=[],r.memberList=[],r.totalItems=null,r.currentPage=1,r.maxSize=5,r.numPerPage=10,r.search_keyword="",r.error="",r.success_msg="",r.numPerPageCap=[10,25,50,100],r.pageCap=r.numPerPageCap[0],r.numPerPage=r.numPerPageCap[0],c(),r.newItem={group:{},admin:{},member:{},groupName:"",groupEmployee:{group:{},employeeUser:{}}},r.newGroup={groupName:""},r.selectedGroup={},n.showNav(!0),r.searchItem=function(){if(""==r.search_keyword)i();else{r.searchList=a("filter")(r.itemList,r.search_keyword),r.totalItems=r.searchList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.searchList.slice(e,t)}},r.changeNumPerPage=function(){r.numPerPage=r.pageCap,i()},r.setSelectedGroup=function(e){r.error="",r.selectedGroup=e},r.setSelectedMember=function(e,t){r.error="",r.selectedMember.group=e,r.selectedMember.employeeUser=t},r.setSelectedAdmin=function(e,t){r.error="",r.selectedAdmin.group=e,r.selectedAdmin.employeeUser=t},r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)},r.showGroup=function(e){o.go("group-detail",{group:e})},r.$on("groupUpdateBroadcast",function(e,t){c()}),r.addGroup=function(){r.error="",s.addGroup(r.newGroup).then(function(e){r.success_message="Group added succesfully!",$("#add-group").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",r.newGroup),c()}).catch(function(e){console.log(e),r.error=e.data.message})},r.editGroup=function(){r.error="",s.editGroup(r.selectedGroup).then(function(e){r.success_message="Group updated succesfully!",$("#edit-group").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",r.selectedGroup),c()}).catch(function(e){console.log(e),r.error=e.data.message})},r.addMember=function(){r.error="",jQuery.isEmptyObject(r.newItem.groupEmployee.employeeUser)?r.error="Please select a member":s.addMember(r.newItem.groupEmployee).then(function(e){r.success_message="Member added succesfully!",$("#add-member").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",r.newItem.groupEmployee.group),r.newItem.groupEmployee={},c()}).catch(function(e){console.log(e)})},r.removeMember=function(t,e){groupEmployee={group:t,employeeUser:e},s.removeMember(groupEmployee).then(function(e){r.success_message="Member removed succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",t),c()}).catch(function(e){console.log(e)})},r.addAdmin=function(){r.error="",jQuery.isEmptyObject(r.newItem.groupEmployee.employeeUser)?r.error="Please select an admin":s.addAdmin(r.newItem.groupEmployee).then(function(e){r.success_message="Admin added succesfully!",$("#add-admin").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",r.newItem.groupEmployee.group),r.newItem.groupEmployee={},c()}).catch(function(e){console.log(e)})},r.removeAdmin=function(t,e){groupEmployee={group:t,employeeUser:e},s.removeAdmin(groupEmployee).then(function(e){r.success_message="Admin removed succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.$emit("groupUpdateEmit",t),c()}).catch(function(e){console.log(e)})},r.loadMemberSelection=function(t){r.error="",s.getAvailableMembers(t).then(function(e){r.memberList=e.data,r.newItem.groupEmployee.group=t}).catch(function(e){console.log(e)})},r.loadAdminSelection=function(t){r.error="",s.getAvailableAdmins(t).then(function(e){r.adminList=e.data,r.newItem.groupEmployee.group=t}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("DashboardController",["$rootScope","$cookies","$scope","$state","$stomp","TaskDataOp","Access","SocketService",function(e,t,o,r,a,s,n,i){n.showNav(!0),o.itemList=[],o.filteredList=[],o.item={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.error="",o.success_msg="",o.stompClient=null,o.isAdmin=function(){return null!=n.getUser()&&"ADMIN"==n.getUser().role.role},o.isSupervisor=function(){return null!=n.getUser()&&"SUPERVISOR"==n.getUser().role.role},o.isUser=function(){return null!=n.getUser()&&"USER"==n.getUser().role.role},o.isAuthenticated=function(){return n.isAuthenticated()},o.setPage=function(e){o.currentPage=e},n.isAuthenticated()||r.go("login"),o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}}]),angular.module("employeeTracker").controller("LandingPageController",["$rootScope","$cookies","$scope","$state","Access",function(e,t,o,r,a){o.user=a.getUser(),o.isAuthenticated=function(){return a.isAuthenticated()},o.logout=function(){a.user(void 0),t.remove("tracker-token"),r.go("landing")}}]),angular.module("employeeTracker").controller("LoginController",["$rootScope","$scope","$state","$cookies","$http","Access","LoginDataOp",function(e,t,o,r,a,s,n){t.user={},t.error="",t.login=function(){n.login(t.user).then(function(e){token=e.data.access_token,s.getClaimsFromToken(token).then(function(e){data=e.data,r.put("tracker-token",token),s.user(data.principal.user),a.defaults.headers.common.Authorization="Bearer "+token,o.go("home")}).catch(function(e){console.log(e),t.error=e.data.message})}).catch(function(e){console.log(e),t.error=e.data.message})}}]),angular.module("employeeTracker").controller("MainController",["$rootScope","$scope","$state","$stomp","Access",function(e,r,t,o,a){r.canShowNav=function(){switch(visible=!0,t.current.name){case"":case"landing":case"login":visible=!1;break;default:visible=!0}return visible},r.isAuthenticated=function(){return a.isAuthenticated()};r.messages=[],r.message="",r.max=140,r.connect=function(){o.connect("/ActivityTracker/activity-socket",{}).then(function(e){o.subscribe("/user-update/status",function(e,t,o){r.broadcast("taskUpdate",e)}),o.subscribe("/user-update/group",function(e,t,o){r.broadcast("groupUpdateBroadcast",e)})})},r.connect(),r.sendMessage=function(e){o.send("/app/user-status",e,{})},r.sendGroupUpdate=function(e){o.send("/app/group-status",e,{})},r.broadcast=function(e,t){r.$broadcast(e,t)},r.$on("eventEmitedName",function(e,t){r.sendMessage(t)}),r.$on("updateTaskEmit",function(e,t){r.sendMessage(t)}),r.$on("endTaskEmit",function(e,t){o.send("/app/user-status",t,{})}),r.$on("addTaskEmit",function(e,t){o.send("/app/user-status",t,{})}),r.$on("groupUpdateEmit",function(e,t){r.sendGroupUpdate(t)})}]),angular.module("employeeTracker").controller("NavController",["$rootScope","$cookies","$scope","$state","Access",function(e,t,o,r,a){o.error="",o.user=a.getUser(),o.logout=function(){a.user(void 0),t.remove("tracker-token"),r.go("login")},o.isAdmin=function(){return null!=a.getUser()&&"ADMIN"==a.getUser().role.role},o.isUser=function(){return null!=a.getUser()&&"USER"==a.getUser().role.role},o.isAuthenticated=function(){return a.isAuthenticated()}}]),angular.module("employeeTracker").controller("ProfileController",["$scope","$state","Access","AccountDataOp",function(t,e,o,r){t.profile=o.getUser(),t.newPassword="",t.confirmNewPassword="",t.userName=t.profile.username,t.updateProfile=function(){t.error="",user={id:t.profile.id,password:t.newPassword},t.newPassword!=t.confirmNewPassword&&(t.error="password mismatched"),t.newPassword.length<8&&(t.error="password must be at least 8 characters"),""==t.error&&r.updateUser(user).then(function(e){t.success_message="Password updated succesfully!",$("#update-profile").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.error=""}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("SubbordinateController",["$rootScope","$cookies","$scope","$filter","$state","$stomp","GroupDataOp","Access","TaskDataOp",function(e,t,r,a,o,s,n,c,u){function l(){n.getSubordinateTaskList().then(function(e){r.itemList=e.data,r.itemList.forEach(function(o){o.numSort=!1,o.nameSort=!1,o.taskSort=!1,o.startSort=!1,o.endSort=!1,o.durationSort=!1,o.filteredList=o.memberTasks,o.search=void 0,o.currentPage=1,o.maxSize=6,o.numPerPage=10,o.totalItems=o.memberTasks.length,o.data=o.memberTasks,o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.data.slice(e,t)},o.refresh=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.data.slice(e,t)},o.memberTasks.forEach(function(e){e.duration=a("durationToTime")(e.endDate-e.startDate,e.endDate)}),o.refresh()}),$(function(){$("th>i").click(function(){$(this).toggleClass("fa-caret-down"),$(this).toggleClass("fa-caret-up")})})}).catch(function(e){console.log(e)})}r.success_message="",r.itemList=[],r.filteredList=[],r.item={},r.totalItems=null,r.currentPage=1,r.maxSize=5,r.numPerPage=10,r.search_keyword=void 0,r.numPerPageCap=[10,25,50,100],r.pageCap=r.numPerPageCap[0],r.numPerPage=r.numPerPageCap[0],r.userTaskHistory=[],r.error="",r.success_msg="",r.sortType="employeeNumber",r.sortReverse=!1,r.toggleSort=function(e){r.sortType=e,r.sortReverse=!r.sortReverse},c.showNav(!0),r.options={data:[],columns:["Employee Number","Full Name","Task","Start","End","Duration"]},r.changeNumPerPage=function(){r.numPerPage=r.pageCap,function(){r.totalItems=r.itemList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)}()},r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)},r.$on("taskUpdate",function(e,t){l(),r.getIndexes(t.employee.employeeNumber)}),r.refreshData=function(e){},r.$on("groupUpdateBroadcast",function(e,t){l()}),r.$on("groupUpdate",function(e,t){l()}),r.searchMember=function(e){memberTasks=e.memberTasks,console.log(e),result=a("filter")(memberTasks,e.search),console.log(result),e.data=result,e.totalItems=result.length,e.refresh()},r.sortReverse=!0,r.sortGroup=function(e,t){var o=[],r=e.filteredList;switch(t){case 1:o=a("orderBy")(r,"employee.employeeNumber",e.numSort),e.numSort=!e.numSort;break;case 2:o=a("orderBy")(r,"employee.firstName",e.nameSort),e.nameSort=!e.nameSort;break;case 3:o=a("orderBy")(r,"task.taskName",e.taskSort),e.taskSort=!e.taskSort;break;case 4:o=a("orderBy")(r,"startDate",e.startSort),e.startSort=!e.startSort;break;case 5:o=a("orderBy")(r,"endDate",e.endSort),e.endSort=!e.endSort;break;case 6:o=a("orderBy")(r,"duration",e.durationSort),e.durationSort=!e.durationSort}e.filteredList=o},r.getIndexes=function(e){var o=[];for(i=0;i<r.itemList.length;i++)for(x=0;x<r.itemList[i].memberTasks.length;x++)if(r.itemList[i].memberTasks[x].employee.employeeNumber==e){o.push([i,x]);break}u.getEmployeeTask(e).then(function(t){console.log(t),t.data.duration=a("durationToTime")(t.data.endDate-t.data.startDate,t.data.endDate),o.forEach(function(e){r.itemList[e[0]].filteredList[e[1]]=angular.copy(t.data)})}).catch(function(e){console.log(e)})},l()}]),angular.module("employeeTracker").controller("TaskHistoryController",["$rootScope","$cookies","$scope","$state","$stomp","$location","TaskDataOp","Access","FileSaver","Blob",function(t,o,c,r,a,n,i,u,l,d){c.success_message="",c.itemList=[],c.filteredList=[],c.item={},c.totalItems=null,c.currentPage=1,c.maxSize=5,c.numPerPage=10,c.keyword="",c.numPerPageCap=[10,25,50,100],c.pageCap=c.numPerPageCap[0],c.numPerPage=c.numPerPageCap[0],c.error="",c.success_msg="",c.dateOptions={showWeeks:!1,startingDay:0},c.history={start:new Date,end:new Date},c.report={title:void 0,tasks:[]},c.searchItem=function(){i.getTaskHistory(c.history).success(function(t,o,r,a){console.log(t),c.itemList=[],c.report={title:"test",tasks:[]},t.forEach(function(t){s=moment(t.start),e=moment(t.end),dur=moment.duration(t.endDate-t.startDate),c.itemList.push({employee:t.employee.firstName+" "+t.employee.lastName+" "+(null==t.employee.suffix?"":t.employee.suffix),task:t.task.taskName,start:t.startDate,end:t.endDate,duration:null==t.endDate?"N/A":moment.utc(dur.asMilliseconds()).format("HH:mm:ss")}),c.report.tasks.push({employeeNumber:t.employee.employeeNumber,employee:t.employee.firstName+" "+t.employee.lastName+" "+(null==t.employee.suffix?"":t.employee.suffix),task:t.task.taskName,start:t.startDate,end:t.endDate,duration:null==t.endDate?"N/A":moment.utc(dur.asMilliseconds()).format("HH:mm:ss")})}),c.totalItems=c.itemList.length;var n=(c.currentPage-1)*c.numPerPage,i=n+c.numPerPage;c.filteredList=c.itemList.slice(n,i)}).error(function(e,t,o,r){})},c.canDownload=function(){return 0<c.report.tasks.length},u.showNav(!0),c.changeNumPerPage=function(){c.numPerPage=c.pageCap,function(){c.totalItems=c.itemList.length;var e=(c.currentPage-1)*c.numPerPage,t=e+c.numPerPage;c.filteredList=c.itemList.slice(e,t)}()},c.setPage=function(e){c.currentPage=e},c.pageChanged=function(){console.log("page changed");var e=(c.currentPage-1)*c.numPerPage,t=e+c.numPerPage;c.filteredList=c.itemList.slice(e,t)},c.b64toBlob=function(e,t,o){t=t||"",o=o||512;for(var r=atob(e),a=[],s=0;s<r.length;s+=o){for(var n=r.slice(s,s+o),i=new Array(n.length),c=0;c<n.length;c++)i[c]=n.charCodeAt(c);var u=new Uint8Array(i);a.push(u)}return new d(a,{type:t})},c.download=function(){console.log(c.report),i.downloadReport(c.report).success(function(e,t,o,r){blob=c.b64toBlob(e.contents,"application/octet-stream"),l.saveAs(blob,"report.xlsx")}).error(function(e,t,o,r){console.log(e)})}}]),angular.module("employeeTracker").controller("TaskPreferrenceController",["$scope","$state","Access","TaskDataOp",function(o,e,t,r){o.items={itemList:[],selectedItem:void 0,newItem:void 0,taskSelection:[],error:void 0,loadPreferrences:function(t){r.getTaskPreferrences().then(function(e){o.items.itemList=e.data,t&&t()}).catch(function(e){console.log(e)})},loadSelection:function(t){r.getTaskList().then(function(e){o.items.taskSelection=e.data,t()}).catch(function(e){console.log(e)})},showAddModal:function(){this.loadSelection(function(){$("#add-pref").modal("show")})},addItem:function(){r.addTaskPreferrences(this.selectedItem).then(function(e){console.log(e),o.items.selectedItem=void 0,o.items.loadPreferrences(function(){$("#add-pref").modal("hide")})}).catch(function(e){console.log(e),o.items.error="Duplicate entry"})},deleteItem:function(e){r.deleteTaskPreferrences(e).then(function(e){console.log(e),o.items.loadPreferrences(function(){})}).catch(function(e){console.log(e)})}},o.loading=!0,o.items.loadPreferrences(function(){o.loading=!1}),o.items.loadSelection(function(){})}]),angular.module("employeeTracker").controller("TaskController",["$rootScope","$cookies","$scope","$state","$filter","TaskDataOp","Access",function(e,t,r,o,a,s,n){function i(){s.getTaskList().then(function(e){r.itemList=e.data,r.totalItems=r.itemList.length;var t=(r.currentPage-1)*r.numPerPage,o=t+r.numPerPage;r.filteredList=r.itemList.slice(t,o)}).catch(function(e){console.log(e)})}function c(){r.totalItems=r.itemList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)}r.itemList=[],r.filteredList=[],r.item={},r.newItem={},r.selectedItem={},r.totalItems=null,r.currentPage=1,r.maxSize=5,r.numPerPage=10,r.search_keyword="",r.error="",r.success_msg="",r.numPerPageCap=[10,25,50,100],r.pageCap=r.numPerPageCap[0],r.numPerPage=r.numPerPageCap[0],r.changeNumPerPage=function(){r.numPerPage=r.pageCap,c()},i(),r.searchItem=function(){if(""==r.search_keyword)c();else{r.searchList=a("filter")(r.itemList,r.search_keyword),r.totalItems=r.searchList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.searchList.slice(e,t)}},r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)},r.setSelectedItem=function(e){r.selectedItem=e},r.addTask=function(){s.addTask(r.newItem).then(function(e){r.success_message="Task added succesfully!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error="",i()}).catch(function(e){console.log(e),r.error=e.data.message})},r.editTask=function(){s.updateTask(r.selectedItem).then(function(e){r.success_message="Task updated succesfully!",$("#edit-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),r.error="",i()}).catch(function(e){console.log(e),r.error=e.data.message})}}]),angular.module("employeeTracker").controller("UserTaskHistoryController",["$rootScope","$cookies","$scope","$state","TaskDataOp","AccountDataOp","Access","FileSaver","Blob",function(e,t,o,r,a,s,n,i,c){o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.searchResults=[],o.empList=[],o.selectedUser={},o.dateOptions={showWeeks:!1,startingDay:0,minView:"day"},o.history={date:void 0,userId:2,supervisorId:n.getUser().id},o.items={currentPage:1,numPerPageCap:[10,25,50,100],numPerPage:10,totalItems:0,maxSize:6,searchResults:[],filteredList:[],empList:[],selectedUser:void 0,history:{date:void 0,userId:void 0,supervisorId:n.getUser().id},canDownload:!1,searchUserHistory:function(){this.selectedUser&&this.history.date&&(this.history.userId=this.selectedUser.user.id,a.getUserTaskHistory(this.history).then(function(e){o.items.searchResults=e.data,o.items.totalItems=e.data.length,o.items.refresh()}).catch(function(e){console.log(e)}))},refresh:function(){begin=(this.currentPage-1)*this.numPerPage,end=begin+this.numPerPage,this.filteredList=this.searchResults.slice(begin,end)},pageChanged:function(){begin=(this.currentPage-1)*this.numPerPage,end=begin+this.numPerPage,this.filteredList=this.searchResults.slice(begin,end)}},o.searchUserHistory=function(){o.selectedUser.user&&o.history.date&&(o.history.userId=o.selectedUser.user.id,console.log(o.history),a.getUserTaskHistory(o.history).then(function(e){o.items.searchResults=e.data}).catch(function(e){console.log(e)}))},o.searchUserHistory(),o.loadUserTaskHistory=function(){},s.getSubbordinates(n.getUser().id).then(function(e){o.empList=e.data}).catch(function(e){})}]),angular.module("employeeTracker").factory("Access",["$http",function(t){var o=this;return o.user=void 0,o.visible=!1,{user:function(e){o.user=e},getUser:function(){return o.user},showNav:function(e){o.visible=e},canShowNav:function(){return o.visible},isAuthenticated:function(){return null!=o.user&&null!=o.user},getClaimsFromToken:function(e){return t({method:"POST",url:"/ActivityTracker/user-claims",headers:{Authorization:"Bearer "+e}})}}}]),angular.module("employeeTracker").factory("AccountDataOp",["$http",function(t){var e={getAccountList:function(){return t({method:"GET",url:"/ActivityTracker/accounts",headers:{"Content-Type":"application/json; charset=UTF-8"}})},getAccount:function(e){return t({method:"GET",url:"/ActivityTracker/accounts/"+e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getRoleList:function(){return t({method:"GET",url:"/ActivityTracker/accounts/roles",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},addAccount:function(e){return t({method:"POST",url:"/ActivityTracker/accounts",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},updateAccount:function(e){return t({method:"PUT",url:"/ActivityTracker/accounts",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},updateUser:function(e){return t({method:"POST",url:"/ActivityTracker/accounts/updateUser",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},resetAccount:function(e){return t({method:"POST",url:"/ActivityTracker/accounts/resetpassword",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},disableAccount:function(e){return t({method:"POST",url:"/ActivityTracker/accounts/disable",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},enableAccount:function(e){return t({method:"POST",url:"/ActivityTracker/accounts/enable",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},changeAccountRole:function(e){return t({method:"POST",url:"/ActivityTracker/accounts/changeRole",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getSubbordinates:function(e){return t({method:"GET",url:"/ActivityTracker/accounts/supervisors/subbordinates/"+e})}};return e}]),angular.module("employeeTracker").factory("EmployeeDataOp",["$http",function(t){var e={getEmployeeList:function(){return t({method:"GET",url:"/ActivityTracker/employees",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},getEmployee:function(e){return t({method:"GET",url:"/ActivityTracker/employees/"+e,dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},addEmployee:function(e){return t({method:"POST",url:"/ActivityTracker/employees/addEmployee",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},editEmployee:function(e){return t({method:"PUT",url:"/ActivityTracker/employees/editEmployee",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})}};return e}]),angular.module("employeeTracker").factory("GroupDataOp",["$http",function(t){var e={getGroupList:function(){return t({method:"GET",url:"/ActivityTracker/groups",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},addGroup:function(e){return t({method:"POST",url:"/ActivityTracker/groups",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},editGroup:function(e){return t({method:"PUT",url:"/ActivityTracker/groups",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getSubordinateTaskList:function(){return t({method:"GET",url:"/ActivityTracker/group-task",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},getAvailableMembers:function(e){return t({method:"POST",url:"/ActivityTracker/group-members",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getAvailableAdmins:function(e){return t({method:"POST",url:"/ActivityTracker/group-admins",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},addMember:function(e){return t({method:"POST",url:"/ActivityTracker/groups/addMember",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},removeMember:function(e){return t({method:"POST",url:"/ActivityTracker/groups/removeMember",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},addAdmin:function(e){return t({method:"POST",url:"/ActivityTracker/groups/addAdmin",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},removeAdmin:function(e){return t({method:"POST",url:"/ActivityTracker/groups/removeAdmin",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})}};return e}]),angular.module("employeeTracker").factory("DashboardDataOp",["$http",function(e){return{}}]),angular.module("employeeTracker").factory("LandingDataOp",["$http",function(e){return{}}]),angular.module("employeeTracker").factory("LoginDataOp",["$http",function(t){var e={login:function(e){return t({method:"POST",url:"/ActivityTracker/authenticate",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getClaimsFromToken:function(e){return t({url:"/ActivityTracker/user-claims",headers:{Authorization:"Bearer "+e}})}};return e}]),angular.module("employeeTracker").service("SocketService",["$stomp",function(t){var e={subscribe:function(e){t.subscribe("/queue/test",e)},send:function(e){t.send("/app/user-status",e,{priority:9,custom:42})}};return e}]),angular.module("employeeTracker").factory("TaskDataOp",["$http",function(t){var e={getTaskList:function(){return t({method:"GET",url:"/ActivityTracker/tasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},addTask:function(e){return t({method:"POST",url:"/ActivityTracker/tasks",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},updateTask:function(e){return t({method:"PUT",url:"/ActivityTracker/tasks",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getEmployeeTaskList:function(){return t({method:"GET",url:"/ActivityTracker/employee-tasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},addRemarks:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/addRemarks",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getMyTaskList:function(){return t({method:"POST",url:"/ActivityTracker/employee-tasks/myTasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},getUserTaskHistory:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/user-history",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},addEmployeeTask:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/addTask",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},endEmployeeTask:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/endTask",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getTaskHistory:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/history",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},getEmployeeTask:function(e){return t({method:"GET",url:"/ActivityTracker/employee-tasks/employee/"+e,dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},getTaskPreferrences:function(){return t({method:"GET",url:"/ActivityTracker/tasks/preferrences"})},addTaskPreferrences:function(e){return t({method:"POST",url:"/ActivityTracker/tasks/preferrences",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},deleteTaskPreferrences:function(e){return t({method:"PUT",url:"/ActivityTracker/tasks/preferrences",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})},downloadReport:function(e){return t({method:"POST",url:"/ActivityTracker/employee-tasks/report/download",dataType:"json",data:e,headers:{"Content-Type":"application/json; charset=UTF-8"}})}};return e}]),angular.module("employeeTracker").service("WebSocketService",["$q","$timeout",function(e,t){var o={},a=e.defer(),r={client:null,stomp:null},s=[];o.RECONNECT_TIMEOUT=3e4,o.SOCKET_URL="/ActivityTracker/gs-guide-websocket",o.CHAT_TOPIC="/user-update/status",o.CHAT_BROKER="/app/user-update",o.receive=function(){return a.promise},o.subscribe=function(t){r.stomp.subscribe(o.CHAT_TOPIC,function(e){t(e)})},o.send=function(e){var t=Math.floor(1e6*Math.random());r.stomp.send(o.CHAT_BROKER,{priority:9},JSON.stringify({message:e,id:t})),s.push(t)};var n=function(){t(function(){c()},this.RECONNECT_TIMEOUT)},i=function(){r.stomp.subscribe(o.CHAT_TOPIC,function(e){var t,o,r;a.notify((t=e.body,o=JSON.parse(t),(r={}).message=o.message,r.time=new Date(o.time),_.contains(s,o.id)&&(r.self=!0,s=_.remove(s,o.id)),r))})},c=function(){r.client=new SockJS(o.SOCKET_URL),r.stomp=Stomp.over(r.client),r.stomp.connect({},i),r.stomp.onclose=n};return c(),o}]);