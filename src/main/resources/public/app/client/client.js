angular.module("employeeTracker",["ui.router","ngCookies","ui.bootstrap","ui.bootstrap.datetimepicker","AxelSoft","ngStomp","ngFileSaver"]),angular.module("employeeTracker").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/"),e.state("home",{url:"/",templateUrl:"/ActivityTracker/app/partials/home.html",controller:"DashboardController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.resolve():o.reject(),o.promise}]}}).state("login",{url:"/login",templateUrl:"/ActivityTracker/app/partials/login.html",controller:"LoginController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.reject():o.resolve(),o.promise}]}}).state("tasks",{url:"/tasks",templateUrl:"/ActivityTracker/app/partials/task.html",controller:"TaskController",resolve:{isAdmin:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("employees",{url:"/employees",templateUrl:"/ActivityTracker/app/partials/employee.html",controller:"EmployeeController",resolve:{isAdmin:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("groups",{url:"/groups",templateUrl:"/ActivityTracker/app/partials/group2.html",controller:"GroupController",resolve:{isNotUser:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"USER"!=t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("accounts",{url:"/accounts",templateUrl:"/ActivityTracker/app/partials/account.html",controller:"AccountController",resolve:{isLoggedIn:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()&&"ADMIN"==t.getUser().role.role?o.resolve():o.reject(),o.promise}]}}).state("profile",{url:"/profile",templateUrl:"/ActivityTracker/app/partials/profile.html",controller:"ProfileController",resolve:{isNotUser:["$q","Access",function(e,t){var o=e.defer();return t.isAuthenticated()?o.resolve():o.reject(),o.promise}]}})}]),angular.module("employeeTracker").run(["$state","$cookies","$http","LoginDataOp","Access",function(e,t,o,r,a){token=t.get("tracker-token"),a.getClaimsFromToken(token).then(function(r){data=r.data,""==data?e.go("login"):(o.defaults.headers.common.Authorization="Bearer "+token,t.put("tracker-token",token),a.user(data.principal.user),e.go("home"))}).catch(function(t){console.log(t),e.go("login")})}]),angular.module("employeeTracker").filter("durationToTime",[function(){return function(e,t){return t?moment.utc(e).format("HH:mm:ss"):"N/A"}}]),angular.module("employeeTracker").controller("AccountController",["$rootScope","$cookies","$scope","$state","$filter","AccountDataOp","EmployeeDataOp","Access",function(e,t,o,r,a,n,s,c){function i(){n.getAccountList().then(function(e){o.itemList=e.data,o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,r=t+o.numPerPage;o.filteredList=o.itemList.slice(t,r)}).catch(function(e){console.log(e)})}function u(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}o.itemList=[],o.filteredList=[],o.item={},o.newItem={},o.selectedItem={},o.employeeList=[],o.selectedEmployee={},o.roleList=[],o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.employee_search="",o.error="",o.success_msg="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.newItem={user:{role:{}},employee:{}},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,u()},i(),o.loadAccount=function(){o.error="",s.getEmployeeList().then(function(e){o.employeeList=e.data}).catch(function(e){console.log(e)}),n.getRoleList().then(function(e){o.roleList=e.data,o.newItem.user.role=o.roleList.length>0?o.roleList[0]:{}}).catch(function(e){console.log(e)})},o.searchItem=function(){if(""==o.search_keyword)u();else{o.searchList=a("filter")(o.itemList,o.search_keyword),o.totalItems=o.searchList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.searchList.slice(e,t)}},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.setSelectedItem=function(e){o.selectedItem=e},o.showModal=function(){o.error=""},o.hideModal=function(){o.error=""},o.addAccount=function(){o.error="",angular.equals({},o.newItem.employee)?o.error="Please select an employee":n.addAccount(o.newItem).then(function(e){o.success_message="User account added succesfully!",$("#add-account").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",i()}).catch(function(e){console.log(e),o.error=e.data.message})},o.updateAccount=function(){n.updateAccount(o.selectedItem).then(function(e){o.success_message="User account updated succesfully!",$("#edit-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",i()}).catch(function(e){console.log(e),o.error=e.data.message})},o.disableAccount=function(e){n.disableAccount(e).then(function(e){o.success_message="Account disabled succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",i()}).catch(function(e){o.error=e.data.message})},o.enableAccount=function(e){n.enableAccount(e).then(function(e){o.success_message="Account enabled succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",i()}).catch(function(e){o.error=e.data.message})},o.resetAccount=function(e){n.resetAccount(e).then(function(e){o.success_message="Password reset succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",i()}).catch(function(e){o.error=e.data.message})}}]),angular.module("employeeTracker").controller("EmployeeTaskController",["$rootScope","$cookies","$scope","$state","$stomp","TaskDataOp","Access",function(e,t,o,r,a,n,s){function c(){n.getMyTaskList().then(function(e){o.itemList=e.data,o.itemList.length>0&&(null==o.itemList[0].endDate?$("#add-task-btn").prop("disabled",!0):$("#add-task-btn").prop("disabled",!1)),o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,r=t+o.numPerPage;o.filteredList=o.itemList.slice(t,r)}).catch(function(e){console.log(e)})}o.success_message="",o.itemList=[],o.filteredList=[],o.item={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.error="",o.success_msg="",c(),s.showNav(!0),o.search=function(){},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,function(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.emitEvent=function(e,t){o.$emit(e,t)},o.endTask=function(e){n.endEmployeeTask(e).then(function(e){o.success_message="Task ended!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.$emit("endTaskEmit",o.itemList[0]),c()}).catch(function(e){console.log(e)})},o.taskList=[],o.selectedTask={},o.loadTask=function(){n.getTaskList().then(function(e){o.taskList=e.data,o.selectedTask=o.taskList.length>0?o.taskList[0]:{}}).catch(function(e){console.log(e)})},o.loadTask(),o.addTask=function(){n.addEmployeeTask(o.selectedTask).then(function(e){o.success_message="New task started!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),c(),console.log(o.itemList[0]),console.log("emitting addTask event"),o.$emit("addTaskEmit",o.itemList[0])}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("EmployeeController",["$rootScope","$cookies","$scope","$state","$filter","EmployeeDataOp","Access",function(e,t,o,r,a,n,s){function c(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}function i(){n.getEmployeeList().then(function(e){o.itemList=e.data,o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,r=t+o.numPerPage;o.filteredList=o.itemList.slice(t,r)}).catch(function(e){console.log(e)})}o.newItem={},o.selectedItem={},o.itemList=[],o.filteredList=[],o.item={},o.keyword="",o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=25,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.error="",o.success_msg="",o.sortType="employeeNumber",o.sortReverse=!1,o.toggleSort=function(e){o.sortType=e,o.sortReverse=!o.sortReverse},i(),s.showNav(!0),o.searchItem=function(){if(""==o.search_keyword)c();else{o.searchList=a("filter")(o.itemList,o.search_keyword),o.totalItems=o.searchList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.searchList.slice(e,t)}},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,c()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.setSelectedItem=function(e){o.selectedItem=e},o.addEmployee=function(){n.addEmployee(o.newItem).then(function(e){o.success_message="Employee added succesfully!",$("#add-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),i()}).catch(function(e){console.log(e),o.error=e.data.message})},o.editEmployee=function(){n.editEmployee(o.selectedItem).then(function(e){o.success_message="Employee updated succesfully!",$("#edit-employee").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),i()}).catch(function(e){console.log(e),o.error=e.data.message})},$("#edit-employee").on("hidden.bs.modal",function(){})}]),angular.module("employeeTracker").controller("GroupDetailController",["$rootScope","$scope","$cookies","$state","$stateParams","Access",function(e,t,o,r,a,n){token=o.get("tracker-token"),void 0==token?r.go("landing"):n.getClaimsFromToken(token).then(function(e){data=e.data,data.authenticated&&(n.user(data.principal.user),"SUPERVISOR"!=data.principal.user.role.role&&r.go("home"))}).catch(function(e){o.remove("tracker-token"),n.user(void 0),r.go("landing")}),null==a.group&&r.go("home"),t.group=a.group,t.memberList=[],t.adminList=[],t.adminList=t.group.admin,t.memberList=t.group.members}]),angular.module("employeeTracker").controller("GroupController",["$rootScope","$scope","$cookies","$state","GroupDataOp","Access",function(e,t,o,r,a,n){function s(){t.error="",a.getGroupList().then(function(e){t.itemList=e.data,t.totalItems=t.itemList.length;var o=(t.currentPage-1)*t.numPerPage,r=o+t.numPerPage;t.filteredList=t.itemList.slice(o,r)}).catch(function(e){console.log(e)})}t.itemList=[],t.filteredList=[],t.item={},t.newItem={},t.adminList=[],t.memberList=[],t.totalItems=null,t.currentPage=1,t.maxSize=5,t.numPerPage=10,t.search_keyword="",t.error="",t.success_msg="",t.numPerPageCap=[10,25,50,100],t.pageCap=t.numPerPageCap[0],t.numPerPage=t.numPerPageCap[0],s(),t.newItem={group:{},admin:{},member:{},groupName:"",groupEmployee:{group:{},employeeUser:{}}},t.newGroup={groupName:""},t.selectedGroup={},n.showNav(!0),t.search=function(){},t.setSelectedGroup=function(e){t.error="",t.selectedGroup=e},t.setSelectedMember=function(e,o){t.error="",t.selectedMember.group=e,t.selectedMember.employeeUser=o},t.setSelectedAdmin=function(e,o){t.error="",t.selectedAdmin.group=e,t.selectedAdmin.employeeUser=o},t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){var e=(t.currentPage-1)*t.numPerPage,o=e+t.numPerPage;t.filteredList=t.itemList.slice(e,o)},t.showGroup=function(e){r.go("group-detail",{group:e})},t.$on("groupUpdateBroadcast",function(e,t){console.log("groupUpdate broadcast event received groupController"),s()}),t.addGroup=function(){t.error="",a.addGroup(t.newGroup).then(function(e){console.log(e),t.success_message="Group added succesfully!",$("#add-group").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),console.log("emiting group event"),t.$emit("groupUpdateEmit",t.newGroup),s()}).catch(function(e){console.log(e),t.error=e.data.message})},t.editGroup=function(){t.error="",a.editGroup(t.selectedGroup).then(function(e){console.log(e),t.success_message="Group updated succesfully!",$("#edit-group").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.$emit("groupUpdateEmit",t.selectedGroup),s()}).catch(function(e){console.log(e),t.error=e.data.message})},t.addMember=function(){t.error="",jQuery.isEmptyObject(t.newItem.groupEmployee.employeeUser)?t.error="Please select a member":a.addMember(t.newItem.groupEmployee).then(function(e){t.success_message="Member added succesfully!",$("#add-member").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.$emit("groupUpdateEmit",t.newItem.groupEmployee.group),t.newItem.groupEmployee={},s()}).catch(function(e){console.log(e)})},t.removeMember=function(e,o){groupEmployee={group:e,employeeUser:o},a.removeMember(groupEmployee).then(function(o){t.success_message="Member removed succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.$emit("groupUpdateEmit",e),s()}).catch(function(e){console.log(e)})},t.addAdmin=function(){t.error="",jQuery.isEmptyObject(t.newItem.groupEmployee.employeeUser)?t.error="Please select an admin":a.addAdmin(t.newItem.groupEmployee).then(function(e){t.success_message="Admin added succesfully!",$("#add-admin").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.$emit("groupUpdateEmit",t.newItem.groupEmployee.group),t.newItem.groupEmployee={},s()}).catch(function(e){console.log(e)})},t.removeAdmin=function(e,o){groupEmployee={group:e,employeeUser:o},a.removeAdmin(groupEmployee).then(function(o){t.success_message="Admin removed succesfully!",$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),t.$emit("groupUpdateEmit",e),s()}).catch(function(e){console.log(e)})},t.loadMemberSelection=function(e){t.error="",a.getAvailableMembers(e).then(function(o){t.memberList=o.data,t.newItem.groupEmployee.group=e}).catch(function(e){console.log(e)})},t.loadAdminSelection=function(e){t.error="",a.getAvailableAdmins(e).then(function(o){t.adminList=o.data,t.newItem.groupEmployee.group=e}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("DashboardController",["$rootScope","$cookies","$scope","$state","$stomp","TaskDataOp","Access","SocketService",function(e,t,o,r,a,n,s,c){s.showNav(!0),o.itemList=[],o.filteredList=[],o.item={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.error="",o.success_msg="",o.stompClient=null,o.isAdmin=function(){return void 0!=s.getUser()&&"ADMIN"==s.getUser().role.role},o.isSupervisor=function(){return void 0!=s.getUser()&&"SUPERVISOR"==s.getUser().role.role},o.isUser=function(){return void 0!=s.getUser()&&"USER"==s.getUser().role.role},o.isAuthenticated=function(){return s.isAuthenticated()},o.setPage=function(e){o.currentPage=e},s.isAuthenticated()||r.go("login"),o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}}]),angular.module("employeeTracker").controller("LandingPageController",["$rootScope","$cookies","$scope","$state","Access",function(e,t,o,r,a){o.user=a.getUser(),o.isAuthenticated=function(){return a.isAuthenticated()},o.logout=function(){a.user(void 0),t.remove("tracker-token"),r.go("landing")}}]),angular.module("employeeTracker").controller("LoginController",["$rootScope","$scope","$state","$cookies","$http","Access","LoginDataOp",function(e,t,o,r,a,n,s){t.user={},t.error="",t.login=function(){s.login(t.user).then(function(e){token=e.data.access_token,n.getClaimsFromToken(token).then(function(e){data=e.data,r.put("tracker-token",token),n.user(data.principal.user),a.defaults.headers.common.Authorization="Bearer "+token,o.go("home")}).catch(function(e){console.log(e),t.error=e.data.message})}).catch(function(e){console.log(e),t.error=e.data.message})}}]),angular.module("employeeTracker").controller("MainController",["$rootScope","$scope","$state","$stomp","Access",function(e,t,o,r,a){t.canShowNav=function(){switch(visible=!0,o.current.name){case"":case"landing":case"login":visible=!1;break;default:visible=!0}return visible},t.isAuthenticated=function(){return a.isAuthenticated()};t.messages=[],t.message="",t.max=140,t.connect=function(){r.connect("/ActivityTracker/activity-socket",{}).then(function(e){r.subscribe("/user-update/status",function(e,o,r){t.broadcast("taskUpdate",e)}),r.subscribe("/user-update/group",function(e,o,r){t.broadcast("groupUpdateBroadcast",e)})})},t.connect(),t.sendMessage=function(e){r.send("/app/user-status",e,{})},t.sendGroupUpdate=function(e){r.send("/app/group-status",e,{})},t.broadcast=function(e,o){t.$broadcast(e,o)},t.$on("eventEmitedName",function(e,o){t.sendMessage(o)}),t.$on("endTaskEmit",function(e,t){r.send("/app/user-status",t,{})}),t.$on("addTaskEmit",function(e,t){r.send("/app/user-status",t,{})}),t.$on("groupUpdateEmit",function(e,o){t.sendGroupUpdate(o)})}]),angular.module("employeeTracker").controller("NavController",["$rootScope","$cookies","$scope","$state","Access",function(e,t,o,r,a){o.user={},o.error="",o.logout=function(){a.user(void 0),t.remove("tracker-token"),r.go("login")},o.isAdmin=function(){return void 0!=a.getUser()&&"ADMIN"==a.getUser().role.role},o.isUser=function(){return void 0!=a.getUser()&&"USER"==a.getUser().role.role},o.isAuthenticated=function(){return a.isAuthenticated()}}]),angular.module("employeeTracker").controller("ProfileController",["$scope","$state","Access","AccountDataOp",function(e,t,o,r){e.profile=o.getUser(),e.newPassword="",e.confirmNewPassword="",e.userName=e.profile.username,e.updateProfile=function(){e.error="",user={id:e.profile.id,password:e.newPassword},e.newPassword!=e.confirmNewPassword&&(e.error="password mismatched"),e.newPassword.length<8&&(e.error="password must be at least 8 characters"),""==e.error&&r.updateUser(user).then(function(t){e.success_message="Password updated succesfully!",$("#update-profile").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),e.error=""}).catch(function(e){console.log(e)})}}]),angular.module("employeeTracker").controller("SubbordinateController",["$rootScope","$cookies","$scope","$state","$stomp","GroupDataOp","Access",function(e,t,o,r,a,n,s){function c(){n.getSubordinateTaskList().then(function(e){o.itemList=e.data,o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,r=t+o.numPerPage;o.filteredList=o.itemList.slice(t,r)}).catch(function(e){console.log(e)})}o.success_message="",o.itemList=[],o.filteredList=[],o.item={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.error="",o.success_msg="",s.showNav(!0),o.search=function(){},o.changeNumPerPage=function(){o.numPerPage=o.pageCap,function(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}()},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.$on("taskUpdate",function(e,t){c()}),o.$on("groupUpdateBroadcast",function(e,t){c()}),o.$on("groupUpdate",function(e,t){c()}),c()}]),angular.module("employeeTracker").controller("TaskHistoryController",["$rootScope","$cookies","$scope","$state","$stomp","$location","TaskDataOp","Access","FileSaver","Blob",function(t,o,r,a,n,c,i,u,l,m){r.success_message="",r.itemList=[],r.filteredList=[],r.item={},r.totalItems=null,r.currentPage=1,r.maxSize=5,r.numPerPage=10,r.keyword="",r.numPerPageCap=[10,25,50,100],r.pageCap=r.numPerPageCap[0],r.numPerPage=r.numPerPageCap[0],r.error="",r.success_msg="",r.dateOptions={showWeeks:!1,startingDay:0},r.history={start:new Date,end:new Date},r.report={title:void 0,tasks:[]},r.searchItem=function(){i.getTaskHistory(r.history).success(function(t,o,a,n){console.log(t),r.itemList=[],r.report={title:"test",tasks:[]},t.forEach(function(t){s=moment(t.start),e=moment(t.end),dur=moment.duration(t.endDate-t.startDate),r.itemList.push({employee:t.employee.firstName+" "+t.employee.lastName+" "+t.employee.suffix,task:t.task.taskName,start:t.startDate,end:t.endDate,duration:null==t.endDate?"N/A":moment.utc(dur.asMilliseconds()).format("HH:mm:ss")}),r.report.tasks.push({employeeNumber:t.employee.employeeNumber,employee:t.employee.firstName+" "+t.employee.lastName+" "+t.employee.suffix,task:t.task.taskName,start:t.startDate,end:t.endDate,duration:null==t.endDate?"N/A":moment.utc(dur.asMilliseconds()).format("HH:mm:ss")})}),console.log(r.itemList),r.totalItems=r.itemList.length;var c=(r.currentPage-1)*r.numPerPage,i=c+r.numPerPage;r.filteredList=r.itemList.slice(c,i)}).error(function(e,t,o,r){console.log(error)})},r.canDownload=function(){return r.report.tasks.length>0},u.showNav(!0),r.changeNumPerPage=function(){r.numPerPage=r.pageCap,function(){r.totalItems=r.itemList.length;var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)}()},r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){var e=(r.currentPage-1)*r.numPerPage,t=e+r.numPerPage;r.filteredList=r.itemList.slice(e,t)},r.b64toBlob=function(e,t,o){t=t||"",o=o||512;for(var r=atob(e),a=[],n=0;n<r.length;n+=o){for(var s=r.slice(n,n+o),c=new Array(s.length),i=0;i<s.length;i++)c[i]=s.charCodeAt(i);var u=new Uint8Array(c);a.push(u)}return new m(a,{type:t})},r.download=function(){i.downloadReport(r.report).success(function(e,t,o,a){console.log(e),blob=r.b64toBlob(e.contents,"application/octet-stream"),l.saveAs(blob,"report.xlsx")}).error(function(e,t,o,r){console.log(e)})}}]),angular.module("employeeTracker").controller("TaskController",["$rootScope","$cookies","$scope","$state","$filter","TaskDataOp","Access",function(e,t,o,r,a,n,s){function c(){n.getTaskList().then(function(e){o.itemList=e.data,o.totalItems=o.itemList.length;var t=(o.currentPage-1)*o.numPerPage,r=t+o.numPerPage;o.filteredList=o.itemList.slice(t,r)}).catch(function(e){console.log(e)})}function i(){o.totalItems=o.itemList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)}o.itemList=[],o.filteredList=[],o.item={},o.newItem={},o.selectedItem={},o.totalItems=null,o.currentPage=1,o.maxSize=5,o.numPerPage=10,o.search_keyword="",o.error="",o.success_msg="",o.numPerPageCap=[10,25,50,100],o.pageCap=o.numPerPageCap[0],o.numPerPage=o.numPerPageCap[0],o.changeNumPerPage=function(){o.numPerPage=o.pageCap,i()},c(),o.searchItem=function(){if(""==o.search_keyword)i();else{o.searchList=a("filter")(o.itemList,o.search_keyword),o.totalItems=o.searchList.length;var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.searchList.slice(e,t)}},o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){var e=(o.currentPage-1)*o.numPerPage,t=e+o.numPerPage;o.filteredList=o.itemList.slice(e,t)},o.setSelectedItem=function(e){o.selectedItem=e},o.addTask=function(){n.addTask(o.newItem).then(function(e){o.success_message="Task added succesfully!",$("#add-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",c()}).catch(function(e){console.log(e),o.error=e.data.message})},o.editTask=function(){n.updateTask(o.selectedItem).then(function(e){o.success_message="Task updated succesfully!",$("#edit-task").modal("hide"),$("#successModal").modal("show"),setTimeout(function(){$("#successModal").modal("hide")},3e3),o.error="",c()}).catch(function(e){console.log(e),o.error=e.data.message})}}]),angular.module("employeeTracker").factory("Access",["$http",function(e){var t=this;t.user=void 0,t.visible=!1;return{user:function(e){t.user=e},getUser:function(){return t.user},showNav:function(e){t.visible=e},canShowNav:function(){return t.visible},isAuthenticated:function(){return null!=t.user&&void 0!=t.user},getClaimsFromToken:function(t){return e({method:"POST",url:"/ActivityTracker/user-claims",headers:{Authorization:"Bearer "+t}})}}}]),angular.module("employeeTracker").factory("AccountDataOp",["$http",function(e){var t={};return t.getAccountList=function(){return e({method:"GET",url:"/ActivityTracker/accounts",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getRoleList=function(){return e({method:"GET",url:"/ActivityTracker/accounts/roles",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addAccount=function(t){return e({method:"POST",url:"/ActivityTracker/accounts",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.updateAccount=function(t){return e({method:"PUT",url:"/ActivityTracker/accounts",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.updateUser=function(t){return e({method:"POST",url:"/ActivityTracker/accounts/updateUser",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.resetAccount=function(t){return e({method:"POST",url:"/ActivityTracker/accounts/resetpassword",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.disableAccount=function(t){return e({method:"POST",url:"/ActivityTracker/accounts/disable",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.enableAccount=function(t){return e({method:"POST",url:"/ActivityTracker/accounts/enable",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t}]),angular.module("employeeTracker").factory("EmployeeDataOp",["$http",function(e){var t={};return t.getEmployeeList=function(){return e({method:"GET",url:"/ActivityTracker/employees",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addEmployee=function(t){return e({method:"POST",url:"/ActivityTracker/employees/addEmployee",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.editEmployee=function(t){return e({method:"PUT",url:"/ActivityTracker/employees/editEmployee",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t}]),angular.module("employeeTracker").factory("GroupDataOp",["$http",function(e){var t={};return t.getGroupList=function(){return e({method:"GET",url:"/ActivityTracker/groups",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addGroup=function(t){return e({method:"POST",url:"/ActivityTracker/groups",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.editGroup=function(t){return e({method:"PUT",url:"/ActivityTracker/groups",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getSubordinateTaskList=function(){return e({method:"GET",url:"/ActivityTracker/group-task",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getAvailableMembers=function(t){return e({method:"POST",url:"/ActivityTracker/group-members",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getAvailableAdmins=function(t){return e({method:"POST",url:"/ActivityTracker/group-admins",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addMember=function(t){return e({method:"POST",url:"/ActivityTracker/groups/addMember",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.removeMember=function(t){return e({method:"POST",url:"/ActivityTracker/groups/removeMember",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addAdmin=function(t){return e({method:"POST",url:"/ActivityTracker/groups/addAdmin",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.removeAdmin=function(t){return e({method:"POST",url:"/ActivityTracker/groups/removeAdmin",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t}]),angular.module("employeeTracker").factory("DashboardDataOp",["$http",function(e){return{}}]),angular.module("employeeTracker").factory("LandingDataOp",["$http",function(e){return{}}]),angular.module("employeeTracker").factory("LoginDataOp",["$http",function(e){var t={};return t.login=function(t){return e({method:"POST",url:"/ActivityTracker/authenticate",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getClaimsFromToken=function(t){return e({url:"/ActivityTracker/user-claims",headers:{Authorization:"Bearer "+t}})},t}]),angular.module("employeeTracker").service("SocketService",["$stomp",function(e){var t={};return t.subscribe=function(t){e.subscribe("/queue/test",t)},t.send=function(t){e.send("/app/user-status",t,{priority:9,custom:42})},t}]),angular.module("employeeTracker").factory("TaskDataOp",["$http",function(e){var t={};return t.getTaskList=function(){return e({method:"GET",url:"/ActivityTracker/tasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addTask=function(t){return e({method:"POST",url:"/ActivityTracker/tasks",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.updateTask=function(t){return e({method:"PUT",url:"/ActivityTracker/tasks",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getEmployeeTaskList=function(){return e({method:"GET",url:"/ActivityTracker/employee-tasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getMyTaskList=function(){return e({method:"POST",url:"/ActivityTracker/employee-tasks/myTasks",dataType:"json",headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.addEmployeeTask=function(t){return e({method:"POST",url:"/ActivityTracker/employee-tasks/addTask",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.endEmployeeTask=function(t){return e({method:"POST",url:"/ActivityTracker/employee-tasks/endTask",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.getTaskHistory=function(t){return e({method:"POST",url:"/ActivityTracker/employee-tasks/history",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t.downloadReport=function(t){return e({method:"POST",url:"/ActivityTracker/employee-tasks/report/download",dataType:"json",data:t,headers:{"Content-Type":"application/json; charset=UTF-8"}})},t}]),angular.module("employeeTracker").service("WebSocketService",["$q","$timeout",function(e,t){var o={},r=e.defer(),a={client:null,stomp:null},n=[];o.RECONNECT_TIMEOUT=3e4,o.SOCKET_URL="/ActivityTracker/gs-guide-websocket",o.CHAT_TOPIC="/user-update/status",o.CHAT_BROKER="/app/user-update",o.receive=function(){return r.promise},o.subscribe=function(e){a.stomp.subscribe(o.CHAT_TOPIC,function(t){e(t)})},o.send=function(e){var t=Math.floor(1e6*Math.random());a.stomp.send(o.CHAT_BROKER,{priority:9},JSON.stringify({message:e,id:t})),n.push(t)};var s=function(){a.client=new SockJS(o.SOCKET_URL),a.stomp=Stomp.over(a.client),a.stomp.connect({},function(){a.stomp.subscribe(o.CHAT_TOPIC,function(e){r.notify(function(e){var t=JSON.parse(e),o={};return o.message=t.message,o.time=new Date(t.time),_.contains(n,t.id)&&(o.self=!0,n=_.remove(n,t.id)),o}(e.body))})}),a.stomp.onclose=function(){t(function(){s()},this.RECONNECT_TIMEOUT)}};return s(),o}]);